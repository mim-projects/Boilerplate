<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        xmlns:p="http://primefaces.org/ui"
        xmlns:h="http://java.sun.com/jsf/html"
        template="/templates/template_admin.xhtml">
    <ui:define name="content_body">
        <div class="container">
            <h:form id="form_data" styleClass="card">
                <div class="title-card">
                    <div class="title-card-icon-text">
                        <i class="pi pi-slack"/>
                        <span>#{bundle.projects}</span>
                    </div>
                    <div>
                        <p:commandButton actionListener="#{projectCtrl.preCreateOrEdit(null)}"
                                         update="create" oncomplete="PF('create_wv').show()"
                                         icon="pi pi-plus" value="#{bundle.add}"/>
                    </div>
                </div>
                <div class="content-card">
                    <div style="overflow-x: auto">
                        <p:dataTable tableStyle="min-width: 70rem !important;"
                                     value="#{projectCtrl.allProjects}" var="project" styleClass="custom-table"
                                     paginator="true" paginatorPosition="bottom" rows="10">
                            <p:column field="id" width="8rem">
                                <div style="position: relative; display: inline-block;">
                                    <div class="change_image_overlay">
                                        <input type="file" onchange="uploadChangeImageProject('file_#{project.id}', '#{commonCtrl.serverPath}/api/images/upload/project/#{project.id}')" id="file_#{project.id}"/>
                                        <i class="pi pi-pencil"></i>
                                    </div>
                                    <p:badge value="#{project.id}">
                                        <p:avatar icon="pi pi-image" size="xlarge">
                                            <p:graphicImage style="object-fit: cover !important;" url="#{project.icon}" rendered="#{not empty project.icon}"/>
                                        </p:avatar>
                                    </p:badge>
                                </div>
                            </p:column>
                            <p:column headerText="#{bundle.name}" field="nameKeyword">
                                <p:commandButton value="#{project.nameKeyword}" styleClass="ui-button-flat rounded-button"
                                                 actionListener="#{projectCtrl.preUpdatePropertyProject(project)}"
                                                 update="edit_name" oncomplete="PF('edit_name_wv').show()"/>
                            </p:column>
                            <p:column headerText="#{bundle.about}" field="aboutKeyword">
                                <p:commandButton value="#{project.aboutKeyword}" styleClass="ui-button-flat rounded-button"
                                                 actionListener="#{projectCtrl.preUpdatePropertyProject(project)}"
                                                 update="edit_about" oncomplete="PF('edit_about_wv').show()"/>
                            </p:column>
                            <p:column headerText="#{bundle.content}" field="contentKeyword">
                                <p:commandButton value="#{project.contentKeyword}" styleClass="ui-button-flat rounded-button"
                                                 actionListener="#{projectCtrl.navigateContent(project)}"/>
                            </p:column>
                            <p:column headerText="#{bundle.visible_code}" field="visibleCode"/>
                            <p:column headerText="#{bundle.controls}" width="15rem">
                                <p:commandLink styleClass="command-link" value="#{bundle.open}"
                                               actionListener="#{projectCtrl.navigateSection(project)}"/>
                                <p:commandLink styleClass="command-link" value="#{bundle.edit}"
                                               actionListener="#{projectCtrl.preCreateOrEdit(project)}"
                                               update="edit" oncomplete="PF('edit_wv').show()"/>
                                <p:commandLink styleClass="command-link" value="#{bundle.remove}"
                                               actionListener="#{projectCtrl.remove(project)}" update="form_data">
                                    <p:confirm header="#{bundle.confirmation}" message="#{bundle.confirm_delete}" icon="pi pi-info-circle"/>
                                </p:commandLink>
                            </p:column>
                        </p:dataTable>
                    </div>
                </div>
            </h:form>
        </div>

        <h:form id="create">
            <p:dialog styleClass="custom-dialog" widgetVar="create_wv" header="#{bundle.create_item}"
                      closable="false" resizable="false" draggable="false" blockScroll="true" modal="true">
                <div class="input-group">
                    <p:outputLabel for="@next" value="#{bundle.name}"/>
                    <p:inputText value="#{projectCtrl.currentName}"/>
                </div>
                <div class="input-group" style="margin: 0.5rem 0 2rem 0">
                    <div class="custom-badge-firing" style="padding: 1rem; display: grid">
                        <span style="font-weight: bold; text-transform: uppercase">#{bundle.project_name_definition}</span>
                        <span>
                            <h:outputText escape="false" value="#{bundle.project_name_definition_description}"/>
                        </span>
                    </div>
                </div>
                <div class="input-group">
                    <p:outputLabel for="@next" value="#{bundle.visible_code}"/>
                    <p:inputText value="#{projectCtrl.current.visibleCode}"/>
                </div>
                <div class="input-group" style="margin: 0.5rem 0 2rem 0">
                    <div class="custom-badge-firing" style="padding: 1rem; display: grid">
                        <span style="font-weight: bold; text-transform: uppercase">#{bundle.visible_code_definition}</span>
                        <span>
                            <h:outputText escape="false" value="#{bundle.visible_code_definition_description}"/>
                        </span>
                    </div>
                </div>
                <div style="display: grid; max-height: 50vh">
                    <div style="display: flex; justify-content: flex-end; gap: 1rem">
                        <p:commandButton styleClass="ui-button-secondary" value="#{bundle.cancel}"
                                         oncomplete="PF('create_wv').hide()"/>
                        <p:commandButton value="#{bundle.accept}" actionListener="#{projectCtrl.create()}"
                                         update="form_data" oncomplete="PF('create_wv').hide()"/>
                    </div>
                </div>
            </p:dialog>
        </h:form>

        <h:form id="edit">
            <p:dialog styleClass="custom-dialog" widgetVar="edit_wv" header="#{bundle.edit_item}"
                      closable="false" resizable="false" draggable="false" blockScroll="true" modal="true">
                <div class="input-group">
                    <p:outputLabel for="@next" value="#{bundle.name}"/>
                    <p:inputText value="#{projectCtrl.currentName}"/>
                </div>
                <div class="input-group" style="margin: 0.5rem 0 2rem 0">
                    <div class="custom-badge-firing" style="padding: 1rem; display: grid">
                        <span style="font-weight: bold; text-transform: uppercase">#{bundle.project_name_definition}</span>
                        <span>
                            <h:outputText escape="false" value="#{bundle.project_name_definition_description}"/>
                        </span>
                    </div>
                </div>
                <div class="input-group">
                    <p:outputLabel for="@next" value="#{bundle.visible_code}"/>
                    <p:inputText value="#{projectCtrl.current.visibleCode}"/>
                </div>
                <div class="input-group" style="margin: 0.5rem 0 2rem 0">
                    <div class="custom-badge-firing" style="padding: 1rem; display: grid">
                        <span style="font-weight: bold; text-transform: uppercase">#{bundle.visible_code_definition}</span>
                        <span>
                            <h:outputText escape="false" value="#{bundle.visible_code_definition_description}"/>
                        </span>
                    </div>
                </div>
                <div style="display: grid; max-height: 50vh">
                    <div style="display: flex; justify-content: flex-end; gap: 1rem">
                        <p:commandButton styleClass="ui-button-secondary" value="#{bundle.cancel}"
                                         oncomplete="PF('edit_wv').hide()"/>
                        <p:commandButton value="#{bundle.accept}" actionListener="#{projectCtrl.update()}"
                                         update="form_data" oncomplete="PF('edit_wv').hide()"/>
                    </div>
                </div>
            </p:dialog>
        </h:form>

        <h:form>
            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" styleClass="custom-dialog">
                <p:commandButton value="#{bundle.cancel}" type="button" styleClass="ui-confirmdialog-no ui-button-flat"/>
                <p:commandButton value="#{bundle.accept}" type="button" styleClass="ui-confirmdialog-yes" />
            </p:confirmDialog>
        </h:form>

        <h:form id="edit_name">
            <p:dialog styleClass="custom-dialog-top" widgetVar="edit_name_wv" header="#{bundle.edit_item}"
                      closable="false" resizable="false" draggable="false" blockScroll="true" modal="true">
                <ui:repeat value="#{projectCtrl.nameArray}" var="nameArr" varStatus="indexStatus">
                    <p:outputPanel rendered="#{projectCtrl.renderOptionEditable(indexStatus.index, true)}" styleClass="input-group" style="margin-bottom: 2rem">
                        <div style="display: flex; gap: 0.5rem; align-items: center; width: 100%">
                            <span class="#{nameArr.languageId.icon}"/>
                            <h:outputText value="#{nameArr.languageId.name}"/>
                        </div>
                        <p:inputText value="#{projectCtrl.nameArray[indexStatus.index].value}"/>
                    </p:outputPanel>
                </ui:repeat>
                <div style="display: grid; max-height: 50vh">
                    <div style="display: flex; justify-content: flex-end; gap: 1rem">
                        <p:commandButton styleClass="ui-button-secondary" value="#{bundle.cancel}"
                                         oncomplete="PF('edit_name_wv').hide()"/>
                        <p:commandButton value="#{bundle.accept}" actionListener="#{projectCtrl.updateName()}"
                                         update="form_data" oncomplete="PF('edit_name_wv').hide()"/>
                    </div>
                </div>
            </p:dialog>
        </h:form>

        <h:form id="edit_about">
            <p:dialog styleClass="custom-dialog-top" widgetVar="edit_about_wv" header="#{bundle.edit_item}" style="top: 2rem !important;"
                      closable="false" resizable="false" draggable="false" blockScroll="true" modal="true">
                <ui:repeat value="#{projectCtrl.aboutArray}" var="aboutArr" varStatus="indexStatus">
                    <p:outputPanel rendered="#{projectCtrl.renderOptionEditable(indexStatus.index, false)}" styleClass="input-group" style="margin-bottom: 2rem">
                        <div style="display: flex; gap: 0.5rem; align-items: center; width: 100%">
                            <span class="#{aboutArr.languageId.icon}"/>
                            <h:outputText value="#{aboutArr.languageId.name}"/>
                        </div>
                        <p:inputTextarea rows="3" value="#{projectCtrl.aboutArray[indexStatus.index].value}"/>
                    </p:outputPanel>
                </ui:repeat>
                <div style="display: grid; max-height: 50vh">
                    <div style="display: flex; justify-content: flex-end; gap: 1rem">
                        <p:commandButton styleClass="ui-button-secondary" value="#{bundle.cancel}"
                                         oncomplete="PF('edit_about_wv').hide()"/>
                        <p:commandButton value="#{bundle.accept}" actionListener="#{projectCtrl.updateAbout()}"
                                         update="form_data" oncomplete="PF('edit_about_wv').hide()"/>
                    </div>
                </div>
            </p:dialog>
        </h:form>
    </ui:define>
</ui:composition>